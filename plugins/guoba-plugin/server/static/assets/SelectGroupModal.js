var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b));import{B as BasicTable}from"./TableImg.vue_vue_type_style_index_0_lang.js";import"./BasicForm.vue_vue_type_style_index_0_lang.js";import{d as defineComponent,g7 as FormItemRest,p as propTypes,K as useAttrs,r as ref,a3 as useUserStore,y as unref,a5 as defHttp,g8 as waitRef,j as createVNode,c as resolveComponent,b as _export_sfc,o as openBlock,h as createBlock,i as withCtx,D as mergeProps,v as createBaseVNode,x as createCommentVNode}from"./index.js";import{B as BasicModal,u as useModalInner}from"./index19.js";import{s as selectModalProps,u as useSelectModal}from"./useSelectModal.js";/* empty css       */import"./BasicForm.js";import"./upperFirst.js";import"./uniqBy.js";import"./index21.js";import"./index22.js";import"./useFormItem.js";import"./DeleteOutlined.js";import"./transButton.js";import"./download.js";import"./index23.js";import"./index24.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./index30.js";import"./index32.js";import"./onMountedOrActivated.js";import"./useContentViewHeight.js";import"./ArrowLeftOutlined.js";import"./merge.js";import"./sortable.esm.js";import"./RedoOutlined.js";import"./scrollTo.js";import"./index33.js";function getGroupList(params){return defHttp.get({url:"/oicq/group/list",params:params})}const _sfc_main=defineComponent({name:"SelectGroupModal",components:{BasicModal:BasicModal,BasicTable:BasicTable,FormItemRest:FormItemRest},props:__spreadProps(__spreadValues({},selectModalProps),{modalTitle:propTypes.string.def("选择群")}),emits:["register","getSelectResult"],setup(props,{emit:emit}){const attrs=useAttrs(),tableRef=ref(),userStore=useUserStore(),getBindValue=Object.assign({},unref(props),unref(attrs),{canResize:!1,bordered:!0,size:"small"}),[{rowSelection:rowSelection,visibleChange:visibleChange,selectValues:selectValues,indexColumnProps:indexColumnProps,getSelectResult:getSelectResult,handleDeleteSelected:handleDeleteSelected,selectRows:selectRows}]=useSelectModal(getGroupList,getBindValue),tableScroll=ref({x:!1}),[register,{closeModal:closeModal}]=useModalInner((()=>{return __this=this,__arguments=null,generator=function*(){window.innerWidth<900?tableScroll.value={x:900}:tableScroll.value={x:!1},yield waitRef(tableRef),tableRef.value.setSelectedRowKeys(selectValues.value||[])},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));var __this,__arguments,generator})),searchInfo=ref(props.params),columns=[{title:"头像",dataIndex:"group_id",width:60,customRender:({text:text})=>createVNode(resolveComponent("g-avatar"),{id:text,type:"group",qs:100},null)},{title:"群号",dataIndex:"group_id",width:120},{title:"群名",dataIndex:"group_name",ellipsis:!0,align:"left",customRender({text:text,record:record}){if(record.remark!==text){const isOwner=record.owner_id===userStore.getUserInfo.userId,isAdmin=record.admin_flag,adminText=isOwner?"（群主）":isAdmin?"（管理员）":"";return createVNode("span",null,[createVNode("span",null,[text]),createVNode("span",{style:"color:#999;font-size:8px;"},[adminText])])}return text}},{title:"活跃人数",dataIndex:"active_member_count",width:80,customRender:({text:text})=>(null!=text?text:0)+"人"},{title:"总人数",dataIndex:"member_count",width:80,customRender:({text:text})=>(null!=text?text:0)+"人"}];return{handleOk:function(){getSelectResult(((options,values)=>{emit("getSelectResult",options,values),closeModal()}))},searchInfo:searchInfo,register:register,indexColumnProps:indexColumnProps,visibleChange:visibleChange,getBindValue:getBindValue,getGroupList:getGroupList,formConfig:{baseColProps:{xs:24,sm:8,md:6,lg:8,xl:8,xxl:8},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8,style:{paddingLeft:"8px",textAlign:"left"}},labelCol:{xs:24,sm:6},wrapperCol:{xs:24,sm:18},schemas:[{label:"群号",field:"query_group_id",component:"Input",componentProps:{placeholder:"请输入群号"}},{label:"群名称",field:"query_name",component:"Input",componentProps:{placeholder:"请输入群名称"}}],autoSubmitOnEnter:!0},columns:columns,rowSelection:rowSelection,selectRows:selectRows,selectedTable:{rowKey:"group_id",size:"small",bordered:!0,scroll:{y:390},canResize:!1,pagination:!1,showIndexColumn:!1,columns:[columns[0],__spreadProps(__spreadValues({},columns[1]),{show:!1}),columns[2]]},handleDeleteSelected:handleDeleteSelected,tableScroll:tableScroll,tableRef:tableRef}}}),_hoisted_1=["onClick"];const SelectGroupModal=_export_sfc(_sfc_main,[["render",function(_ctx,_cache,$props,$setup,$data,$options){const _component_BasicTable=resolveComponent("BasicTable"),_component_a_col=resolveComponent("a-col"),_component_Icon=resolveComponent("Icon"),_component_a_row=resolveComponent("a-row"),_component_BasicModal=resolveComponent("BasicModal"),_component_FormItemRest=resolveComponent("FormItemRest");return openBlock(),createBlock(_component_FormItemRest,null,{default:withCtx((()=>[createVNode(_component_BasicModal,mergeProps({width:"800px",title:_ctx.modalTitle,onOk:_ctx.handleOk,onRegister:_ctx.register,onVisibleChange:_ctx.visibleChange},_ctx.$attrs),{default:withCtx((()=>[createVNode(_component_a_row,null,{default:withCtx((()=>[createVNode(_component_a_col,{span:_ctx.showSelected?18:24},{default:withCtx((()=>[createVNode(_component_BasicTable,mergeProps({ref:"tableRef",columns:_ctx.columns,scroll:_ctx.tableScroll},_ctx.getBindValue,{useSearchForm:!0,formConfig:_ctx.formConfig,api:_ctx.getGroupList,searchInfo:_ctx.searchInfo,rowSelection:_ctx.rowSelection,indexColumnProps:_ctx.indexColumnProps}),null,16,["columns","scroll","formConfig","api","searchInfo","rowSelection","indexColumnProps"])])),_:1},8,["span"]),_ctx.showSelected?(openBlock(),createBlock(_component_a_col,{key:0,span:6},{default:withCtx((()=>[createVNode(_component_BasicTable,mergeProps(_ctx.selectedTable,{dataSource:_ctx.selectRows,useSearchForm:!0,formConfig:{showActionButtonGroup:!1,baseRowStyle:{minHeight:"40px"}}}),{action:withCtx((({record:record})=>[createBaseVNode("a",{onClick:$event=>_ctx.handleDeleteSelected(record)},[createVNode(_component_Icon,{icon:"ant-design:delete-outlined"})],8,_hoisted_1)])),_:1},16,["dataSource"])])),_:1})):createCommentVNode("",!0)])),_:1})])),_:1},16,["title","onOk","onRegister","onVisibleChange"])])),_:1})}]]);export{SelectGroupModal as default};
