var __async=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));import{dO as defineStore,fq as Persistent,fr as LOCK_INFO_KEY,a3 as useUserStore}from"./index.js";const useLockStore=defineStore({id:"app-lock",state:()=>({lockInfo:Persistent.getLocal(LOCK_INFO_KEY)}),getters:{getLockInfo(){return this.lockInfo}},actions:{setLockInfo(info){this.lockInfo=Object.assign({},this.lockInfo,info),Persistent.setLocal(LOCK_INFO_KEY,this.lockInfo,!0)},resetLockInfo(){Persistent.removeLocal(LOCK_INFO_KEY,!0),this.lockInfo=null},unLock(password){return __async(this,null,(function*(){var _a;const userStore=useUserStore();if((null==(_a=this.lockInfo)?void 0:_a.pwd)===password)return this.resetLockInfo(),!0;return yield(()=>__async(this,null,(function*(){var _a2;try{const username=null==(_a2=userStore.getUserInfo)?void 0:_a2.username,res=yield userStore.login({username:username,password:password,goHome:!1,mode:"none"});return res&&this.resetLockInfo(),res}catch(error){return!1}})))()}))}}});export{useLockStore as u};
