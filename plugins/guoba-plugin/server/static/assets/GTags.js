var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b));import{d as defineComponent,p as propTypes,r as ref,a as reactive,w as watch,t as toRefs,n as nextTick,u as usePrompt,b as _export_sfc,c as resolveComponent,o as openBlock,e as createElementBlock,F as Fragment,f as renderList,h as createBlock,i as withCtx,j as createVNode,k as createTextVNode,m as toDisplayString,q as withKeys}from"./index.js";import"./index19.js";/* empty css       *//* empty css                                                          */import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";const GTags=_export_sfc(defineComponent({name:"GTags",inheritAttrs:!1,props:{value:propTypes.array.def((()=>[])),allowAdd:propTypes.bool.def(!1),allowDel:propTypes.bool.def(!1),showPrompt:propTypes.bool.def(!1),promptProps:propTypes.object.def((()=>({}))),valueFormatter:propTypes.oneOfType([propTypes.func,propTypes.string])},emits:["change"],setup(props,{emit:emit}){const{createPrompt:createPrompt}=usePrompt(),inputRef=ref(),state=reactive({tags:[],inputVisible:!1,inputValue:""});function handleInputConfirm(){const inputValue=state.inputValue;let tags=state.tags;inputValue&&-1===tags.indexOf(inputValue)&&(tags=[...tags,formatter(inputValue)]),Object.assign(state,{tags:tags,inputVisible:!1,inputValue:""}),onChange()}function formatter(value){if(props.valueFormatter){if("function"!=typeof props.valueFormatter)return new Function(`return ${props.valueFormatter}`)()(value);props.valueFormatter(value)}return value}function onChange(){emit("change",state.tags)}return watch((()=>props.value),(val=>{state.tags=null==val?[]:val}),{immediate:!0}),__spreadProps(__spreadValues({},toRefs(state)),{handleClose:function(removedTag){state.tags=state.tags.filter((tag=>tag!==removedTag)),onChange()},showInput:function(){props.showPrompt?createPrompt(__spreadProps(__spreadValues({title:"添加",required:!0},props.promptProps),{onOk(value){state.inputValue=value,handleInputConfirm()}})):(state.inputVisible=!0,nextTick((()=>{inputRef.value.focus()})))},handleInputConfirm:handleInputConfirm,inputRef:inputRef})}}),[["render",function(_ctx,_cache,$props,$setup,$data,$options){const _component_a_tag=resolveComponent("a-tag"),_component_a_tooltip=resolveComponent("a-tooltip"),_component_a_input=resolveComponent("a-input"),_component_icon=resolveComponent("icon");return openBlock(),createElementBlock(Fragment,null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(_ctx.tags,(tag=>(openBlock(),createElementBlock(Fragment,{key:tag},[tag.length>20?(openBlock(),createBlock(_component_a_tooltip,{key:0,title:tag},{default:withCtx((()=>[createVNode(_component_a_tag,{closable:"",onClose:$event=>_ctx.handleClose(tag)},{default:withCtx((()=>[createTextVNode(toDisplayString(`${tag.slice(0,20)}...`),1)])),_:2},1032,["onClose"])])),_:2},1032,["title"])):(openBlock(),createBlock(_component_a_tag,{key:1,closable:"",onClose:$event=>_ctx.handleClose(tag)},{default:withCtx((()=>[createTextVNode(toDisplayString(tag),1)])),_:2},1032,["onClose"]))],64)))),128)),_ctx.inputVisible?(openBlock(),createBlock(_component_a_input,{key:0,ref:"inputRef",value:_ctx.inputValue,"onUpdate:value":_cache[0]||(_cache[0]=$event=>_ctx.inputValue=$event),type:"text",size:"small",style:{width:"78px"},onBlur:_ctx.handleInputConfirm,onKeyup:withKeys(_ctx.handleInputConfirm,["enter"])},null,8,["value","onBlur","onKeyup"])):(openBlock(),createBlock(_component_a_tag,{key:1,style:{background:"#fff","border-style":"dashed",cursor:"pointer"},onClick:_ctx.showInput},{default:withCtx((()=>[createVNode(_component_icon,{icon:"ant-design:plus"}),createTextVNode(" 新增 ")])),_:1},8,["onClick"]))],64)}]]);export{GTags as default};
