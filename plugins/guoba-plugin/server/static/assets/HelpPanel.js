import{d as defineComponent,g4 as getAppEnvConfig,g5 as createLocalStorage,aB as usePermissionStore,r as ref,C as computed,c as resolveComponent,o as openBlock,e as createElementBlock,v as createBaseVNode,j as createVNode,i as withCtx,W as normalizeStyle,y as unref,b5 as Dropdown,m as toDisplayString,F as Fragment,f as renderList,z as normalizeClass,aV as Transition,x as createCommentVNode,k as createTextVNode,bo as Modal,O as pushScopeId,Q as popScopeId,A as useMessage,b as _export_sfc}from"./index.js";import EditBodyModal from"./EditBodyModal.js";import{g as getHelpIconList}from"./miao.api.js";import{a as useModal}from"./index19.js";import{_ as _sfc_main$1}from"./UploadIconHelpModal.vue_vue_type_script_setup_true_lang.js";import"./index22.js";import"./SelectIconModal.js";import"./IconUploader.js";import"./esm.js";import"./base64Conver.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./21ae6624.js";const _withScopeId=n=>(pushScopeId("data-v-bcfcccc2"),n=n(),popScopeId(),n),_hoisted_1={class:"change-background"},_hoisted_2=_withScopeId((()=>createBaseVNode("input",{type:"file",id:"upload-bg",style:{display:"none"},name:"icon",accept:"image/bmp,image/jpeg,image/png"},null,-1))),_hoisted_3=_withScopeId((()=>createBaseVNode("input",{type:"file",id:"upload-icon",style:{display:"none"},name:"icon",accept:"image/png"},null,-1))),_hoisted_4={class:"title"},_hoisted_5={class:"label"},_hoisted_6=["onClick"],_hoisted_7={key:0,class:"help-table"},_hoisted_8=["onClick"],_hoisted_9={class:"help-title"},_hoisted_10={class:"help-desc"},_hoisted_11={class:"copyright"},_hoisted_12={class:"version"},_hoisted_13={class:"version"},_hoisted_14={class:"p-4"},_hoisted_15={class:"row"},_hoisted_16=_withScopeId((()=>createBaseVNode("div",null,"主标题",-1))),_hoisted_17={class:"flex-1"},_hoisted_18={class:"row"},_hoisted_19=_withScopeId((()=>createBaseVNode("div",null,"副标题",-1))),_hoisted_20={class:"flex-1"},HelpPanel=_export_sfc(defineComponent({__name:"HelpPanel",props:{helpCfg:Object,helpList:Object,bgB64:String,mainB64:String,cacheVer:Number,iconB64List:Array,modelData:Object,versions:Object},emits:["update:modelData","update:mainB64","update:iconB64List"],setup(__props,{emit:__emit}){const{VITE_PUBLIC_PATH:VITE_PUBLIC_PATH}=getAppEnvConfig(),ls=createLocalStorage(),permStore=usePermissionStore(),[registerUihModal,uihModal]=useModal(),props=__props,emits=__emit,{createMessage:$message}=useMessage(),showHeadModal=ref(!1),dropMenuList=ref([{event:"changeBackground",text:"更换背景",icon:"akar-icons:image",onClick(){getUploadBase64("upload-bg",(base64=>{emits("update:mainB64",base64)}))}},{event:"uploadIcon",text:"上传图标",icon:"fontisto:nav-icon-grid",onClick(){let fn=()=>{getUploadBase64("upload-icon",(base64=>{return __this=this,__arguments=null,generator=function*(){let iconList=yield getHelpIconList(base64);emits("update:iconB64List",iconList),$message.success("上传成功")},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));var __this,__arguments,generator}))};!0===ls.get("hide-upload-icon-help-modal",!1)?fn():uihModal.openModal(!0,fn)}}]),isBindEvent={},wrapStyle=computed((()=>{let style={},themePath=`${VITE_PUBLIC_PATH}/api/plugin/miao/help/theme/$s?token=${permStore.liteToken}&_v=${props.cacheVer}`,themeBg=themePath.replace("$s","bg"),themeMain=themePath.replace("$s","main");return props.mainB64&&(themeMain=props.mainB64),style.background=`url(${themeMain}) top left/100% auto no-repeat,url(${themeBg})`,style}));function getUploadBase64(inputId,callback){let input=document.getElementById(inputId);isBindEvent[inputId]||(isBindEvent[inputId]=!0,input.addEventListener("change",(ev=>{let files=ev.target.files;if(0!==files.length){let file=files[0],Reader=new FileReader;Reader.readAsDataURL(file),Reader.onload=()=>{callback(Reader.result),input.value=null}}}))),input.click()}const clickHead=()=>{showHeadModal.value=!0},clickBody=(cell,cellIndex,group,groupIndex)=>{emits("update:modelData",{show:!0,cell:cell,cellIndex:cellIndex,group:group,groupIndex:groupIndex})},split=item_list=>{let result=[];for(let i=0;i<item_list.length;i+=3)result.push(item_list.slice(i,i+3));return result},scale=computed((()=>document.body.clientWidth>850?1:document.body.clientWidth/850));return(_ctx,_cache)=>{const _component_Icon=resolveComponent("Icon"),_component_a_button=resolveComponent("a-button"),_component_a_input=resolveComponent("a-input");return openBlock(),createElementBlock("div",{style:normalizeStyle(`transform: scale(${scale.value});transform-origin: center top;`)},[createBaseVNode("div",{class:"wrap",style:normalizeStyle(wrapStyle.value)},[createBaseVNode("div",_hoisted_1,[_hoisted_2,_hoisted_3,createVNode(unref(Dropdown),{trigger:["click"],dropMenuList:dropMenuList.value},{default:withCtx((()=>[createVNode(_component_a_button,{style:normalizeStyle(`transform: scale(${1/scale.value});transform-origin: right top;`),type:"primary",shape:"circle",size:"large"},{default:withCtx((()=>[createVNode(_component_Icon,{icon:"akar-icons:image"})])),_:1},8,["style"])])),_:1},8,["dropMenuList"])]),createBaseVNode("div",{class:"head-box",onClick:clickHead},[createBaseVNode("div",_hoisted_4,toDisplayString(__props.helpCfg.title),1),createBaseVNode("div",_hoisted_5,toDisplayString(__props.helpCfg.subTitle),1)]),(openBlock(!0),createElementBlock(Fragment,null,renderList(__props.helpList,((group,groupIndex)=>(openBlock(),createElementBlock("div",{class:"cont-box",key:groupIndex},[createBaseVNode("div",{class:"help-group",onClick:$event=>clickBody(null,null,group,groupIndex)},toDisplayString(group.group),9,_hoisted_6),group.list&&group.list.length>0?(openBlock(),createElementBlock("div",_hoisted_7,[(openBlock(!0),createElementBlock(Fragment,null,renderList(split(group.list),((result,row)=>(openBlock(),createElementBlock("div",{class:"tr",key:row},[(openBlock(!0),createElementBlock(Fragment,null,renderList(result,((cell,col)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["td",cell===__props.modelData.cell?"active":"inactive"]),key:col,onClick:$event=>clickBody(cell,3*row+col,group,groupIndex)},[createVNode(Transition,{name:"fade-transition"},{default:withCtx((()=>[createBaseVNode("div",null,[createBaseVNode("div",{class:"help-icon",style:normalizeStyle(`background: url(${__props.iconB64List[cell.icon]}) 0 0 no-repeat`)},null,4),createBaseVNode("div",_hoisted_9,toDisplayString(cell.title),1),createBaseVNode("div",_hoisted_10,toDisplayString(cell.desc),1)])])),_:2},1024)],10,_hoisted_8)))),128))])))),128))])):createCommentVNode("",!0)])))),128)),createBaseVNode("div",_hoisted_11,[createTextVNode(" Created By Yunzai-Bot "),createBaseVNode("span",_hoisted_12,toDisplayString(__props.versions.yunzai),1),createTextVNode(" & Miao-Plugin "),createBaseVNode("span",_hoisted_13,toDisplayString(__props.versions.miao),1)])],4),createVNode(unref(Modal),{visible:showHeadModal.value,"onUpdate:visible":_cache[2]||(_cache[2]=$event=>showHeadModal.value=$event),title:"编辑标题",closable:!1,footer:null},{default:withCtx((()=>[createBaseVNode("div",_hoisted_14,[createBaseVNode("div",_hoisted_15,[_hoisted_16,createBaseVNode("div",_hoisted_17,[createVNode(_component_a_input,{value:__props.helpCfg.title,"onUpdate:value":_cache[0]||(_cache[0]=$event=>__props.helpCfg.title=$event),placeholder:"主标题"},null,8,["value"])])]),createBaseVNode("div",_hoisted_18,[_hoisted_19,createBaseVNode("div",_hoisted_20,[createVNode(_component_a_input,{value:__props.helpCfg.subTitle,"onUpdate:value":_cache[1]||(_cache[1]=$event=>__props.helpCfg.subTitle=$event),placeholder:"附标题"},null,8,["value"])])])])])),_:1},8,["visible"]),createVNode(EditBodyModal,{helpList:__props.helpList,modelData:__props.modelData,iconB64List:__props.iconB64List},null,8,["helpList","modelData","iconB64List"]),createVNode(_sfc_main$1,{onRegister:unref(registerUihModal)},null,8,["onRegister"])],4)}}}),[["__scopeId","data-v-bcfcccc2"]]);export{HelpPanel as default};
