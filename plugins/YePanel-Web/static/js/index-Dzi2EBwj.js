import{d as S,V as q,D,k as L,g as C,e as U,aZ as B,o as M,h as P,c as $,b as d,w as e,y as t,S as A,P as a,J as E,$ as N,aD as T,b8 as F,a8 as H,aF as I,A as f,i as z,x as G,B as J,ae as Y,af as j,_ as K}from"./index-C1DCms5E.js";import{h as O,c as W,b as X,f as ee,g as oe,a as y}from"./dark-D3CqKkB1.js";const g=S({name:"Motion",props:{delay:{type:Number,default:50}},render(){const{delay:i}=this,u=q("motion");return D(L("div",{},{default:()=>[this.$slots.default()]}),[[u,{initial:{opacity:0,y:100},enter:{opacity:1,y:0,transition:{delay:i}}}]])}}),te=C({password:[{validator:(i,u,s)=>{u===""?s(new Error("请输入密码")):u.length<6?s(new Error("密码应为6位字符以上")):s()},trigger:"blur"}]}),ae="/YePanel/static/png/bg-BbeGHte5.png",se={width:24,height:24,body:'<path fill="currentColor" d="M19 10h1a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V11a1 1 0 0 1 1-1h1V9a7 7 0 0 1 14 0v1Zm-2 0V9A5 5 0 0 0 7 9v1h10Zm-6 4v4h2v-4h-2Z"/>'},le={width:24,height:24,body:'<path fill="currentColor" d="M20 22H4v-2a5 5 0 0 1 5-5h6a5 5 0 0 1 5 5v2Zm-8-9a6 6 0 1 1 0-12a6 6 0 0 1 0 12Z"/>'},ne={width:24,height:24,body:'<path fill="currentColor" d="m13.06 8.11l1.415 1.415a7 7 0 0 1 0 9.9l-.354.353a7 7 0 1 1-9.9-9.9l1.415 1.415a5 5 0 0 0 7.07 7.07l.354-.353a5 5 0 0 0 0-7.07l-1.414-1.415L13.06 8.11Zm6.718 6.011l-1.414-1.414a5 5 0 0 0-7.071-7.071l-.354.353a5 5 0 0 0 0 7.071l1.414 1.415l-1.414 1.414l-1.414-1.414a7 7 0 0 1 0-9.9l.353-.353a7 7 0 0 1 9.9 9.9Z"/>'},re=i=>(Y("data-v-436e7b07"),i=i(),j(),i),ie={class:"select-none"},de=["src"],ue={class:"flex-c absolute right-5 top-3"},ce={class:"login-container"},pe=re(()=>d("div",{class:"img"},null,-1)),me={class:"login-box"},fe={class:"login-form"},ge={class:"outline-none"},he=S({name:"Login",__name:"index",setup(i){const u=E(),s=N(),h=U(!1),_=U(),{initStorage:k}=O();k();const{dataTheme:v,dataThemeChange:w}=W();w();const{title:Q}=X(),l=C({username:localStorage.getItem("QQBotUsername")||"",password:localStorage.getItem("QQBotPassword")||"",baseUrl:B()}),b=async n=>{n&&await n.validate((o,c)=>{if(o)V();else return c})},V=({username:n,password:o,baseUrl:c}=l,m=!0)=>{h.value=!0,T().loginByUsername({username:n,password:o,baseUrl:c}).then(p=>{if(p.success)return F().then(()=>{u.push(H(!0).path).then(()=>{I("登录成功",{type:"success"}),m&&(localStorage.setItem("QQBotUsername",n),localStorage.setItem("QQBotPassword",o)),localStorage.setItem("QQBotBaseUrl",c)})});I(p.message,{type:"error"})}).finally(()=>h.value=!1)};s.query.key&&V({username:s.query.key,password:"",baseUrl:s.query.api?`http://${s.query.api}`:B()},!1);function x({code:n}){n==="Enter"&&b(_.value)}return M(()=>{window.document.addEventListener("keypress",x)}),P(()=>{window.document.removeEventListener("keypress",x)}),(n,o)=>{const c=f("el-switch"),m=f("el-input"),p=f("el-form-item"),R=f("el-button"),Z=f("el-form");return z(),$("div",ie,[d("img",{src:e(ae),class:"wave"},null,8,de),d("div",ue,[t(c,{modelValue:e(v),"onUpdate:modelValue":o[0]||(o[0]=r=>A(v)?v.value=r:null),"inline-prompt":"","active-icon":e(ee),"inactive-icon":e(oe),onChange:e(w)},null,8,["modelValue","active-icon","inactive-icon","onChange"])]),d("div",ce,[pe,d("div",me,[d("div",fe,[t(e(g),null,{default:a(()=>[d("h2",ge,G(e(Q)),1)]),_:1}),t(Z,{ref_key:"ruleFormRef",ref:_,model:l,rules:e(te),size:"large"},{default:a(()=>[t(e(g),{delay:100},{default:a(()=>[t(p,{rules:[{required:!0,message:"请输入账号",trigger:"blur"}],prop:"username"},{default:a(()=>[t(m,{modelValue:l.username,"onUpdate:modelValue":o[1]||(o[1]=r=>l.username=r),clearable:"",placeholder:"账号","prefix-icon":e(y)(e(le))},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(e(g),{delay:150},{default:a(()=>[t(p,{prop:"password"},{default:a(()=>[t(m,{modelValue:l.password,"onUpdate:modelValue":o[2]||(o[2]=r=>l.password=r),clearable:"","show-password":"",placeholder:"密码","prefix-icon":e(y)(e(se))},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(e(g),{delay:100},{default:a(()=>[t(p,{rules:[{required:!0,message:"后端API地址不能为空",trigger:"blur"}],prop:"baseUrl"},{default:a(()=>[t(m,{modelValue:l.baseUrl,"onUpdate:modelValue":o[3]||(o[3]=r=>l.baseUrl=r),clearable:"",placeholder:"API","prefix-icon":e(y)(e(ne))},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(e(g),{delay:250},{default:a(()=>[t(R,{class:"w-full mt-4",size:"default",type:"primary",loading:h.value,onClick:o[4]||(o[4]=r=>b(_.value))},{default:a(()=>[J(" 登录 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])])])}}}),ye=K(he,[["__scopeId","data-v-436e7b07"]]);export{ye as default};
